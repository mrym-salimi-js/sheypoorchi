import{r as e,u as b,d as w,j as n,N as x,a as y,b as T,c as j,n as k}from"./index-2i_4_wqC.js";import{A as L}from"./AuthForm-DEx9TWQj.js";function A(){const s=e.useRef([]),[o,u]=e.useState(),f=b(),i=w(),[m,c]=e.useState(!1),v="https://pensive-volhard-wbilxm8r4.liara.run",[d,l]=e.useState({message:"",status:""}),[p,g]=e.useState();e.useEffect(()=>{document.title="ساخت رمز عبور جدید"},[]);const h=async()=>{var r;(r=s==null?void 0:s.current)==null||r.map(a=>{a.value===""?y(t=>{u(t)},a.getAttribute("data-label"),a.value,o,a.type):g(a.value)})};return e.useEffect(()=>{var a;const r=async()=>{try{c(!0);const t=await T.post(`${v}/resetPassword/${i.token}`,{password:s==null?void 0:s.current[0].value,passwordConfirm:s==null?void 0:s.current[1].value},{headers:{Authorization:`Bearer ${i.token}`}});t!==void 0&&(t.data.status==="success"&&l({message:"رمز عبور شما تغییر کرد",status:"success"}),j.remove("user-pass"),k("/login","",f))}catch(t){c(!1),t&&l({message:"رمز عبور موقتی وجود ندارد یا منقضی شده",status:"fail"})}};p&&(o&&((a=Object==null?void 0:Object.keys(o))==null?void 0:a.length)==0||o===void 0)&&r()},[p]),n.jsxs(n.Fragment,{children:[d.message&&n.jsx(x,{setNotif:l,notif:d}),n.jsx(L,{fieldes:[{label:"رمز عبور",type:"password",valueType:"password"},{label:"تکرار رمز عبور",type:"password",valueType:"password"}],handleBtn:h,headerLabel:"ساخت رمز عبور جدید",inputRefs:s,validation:o,setValidation:u,loading:m,otherLink:[{label:"فراموشی رمز عبور!",link:"/forgetPassword"}],btnLabel:"ارسال"})]})}export{A as default};
